Section 17. Imprisonment of witnesses - depositions - form. No person shall be imprisoned for the purpose of securing his testimony in any case longer than may be necessary in order to take his deposition. If he can give security he shall be discharged; if he cannot give security his deposition shall be taken by some judge of the supreme, district or county court, at the earliest time he can attend, at some convenient place by him appointed for that purpose, of which time and place the accused and the attorney prosecuting for the people shall have reasonable notice. The accused shall have the right to appear in person and by counsel. If he has no counsel, the judge shall assign him one in his behalf only. On the completion of such examination the witness shall be discharged on his own recognizance, entered into before said judge, but such deposition shall not be used if in the opinion of the court the personal attendance of the witness might be procured by the prosecution, or is procured by the accused. No exception shall be taken to such deposition as to matters of form.